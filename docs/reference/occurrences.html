<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Get occurrence data — occurrences • ALA4R</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script>
<script src="../pkgdown.js"></script>



<meta property="og:title" content="Get occurrence data — occurrences" />

<meta property="og:description" content="Retrieve ALA occurrence data via the "occurrence download" web service. At least one of taxon, wkt, or fq must be supplied for a valid query. Note that there is a limit of 500000 records per request when using method="indexed". Use the method="offline" for larger requests. For small requests, method="indexed" likely to be faster." />
<meta name="twitter:card" content="summary" />


<!-- mathjax -->
<script src='https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ALA4R</a>
        <span class="label label-default" data-toggle="tooltip" data-placement="bottom" title="Released package">1.6.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/ALA4R.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/AtlasOfLivingAustralia/ALA4R">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Get occurrence data</h1>
    <small class="dont-index">Source: <a href='https://github.com/AtlasOfLivingAustralia/ALA4R/blob/master/R/occurrences.R'><code>R/occurrences.R</code></a></small>
    <div class="hidden name"><code>occurrences.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>Retrieve ALA occurrence data via the "occurrence download" web service. At least one of <code>taxon</code>, <code>wkt</code>, or <code>fq</code> must be supplied for a valid query. Note that there is a limit of 500000 records per request when using <code>method="indexed"</code>. Use the <code>method="offline"</code> for larger requests. For small requests, <code>method="indexed"</code> likely to be faster.</p>
    
    </div>

    <pre class="usage"><span class='fu'>occurrences</span>(<span class='no'>taxon</span>, <span class='no'>wkt</span>, <span class='no'>fq</span>, <span class='no'>fields</span>, <span class='no'>extra</span>, <span class='no'>qa</span>, <span class='kw'>method</span> <span class='kw'>=</span> <span class='st'>"indexed"</span>, <span class='no'>email</span>,
  <span class='kw'>download_reason_id</span> <span class='kw'>=</span> <span class='fu'><a href='ala_config.html'>ala_config</a></span>()$<span class='no'>download_reason_id</span>, <span class='no'>reason</span>,
  <span class='kw'>verbose</span> <span class='kw'>=</span> <span class='fu'><a href='ala_config.html'>ala_config</a></span>()$<span class='no'>verbose</span>, <span class='kw'>record_count_only</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>use_layer_names</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>use_data_table</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>taxon</th>
      <td><p>string: (optional) query of the form field:value (e.g. "genus:Heleioporus") or a free text search (e.g. "macropodidae"). Note that
a free-text search is equivalent to specifying the "text" field (i.e. <code>taxon="Alaba"</code> is equivalent to <code>taxon="text:Alaba"</code>. 
The text field is populated with the taxon name along with a handful of other commonly-used fields, and so just specifying your target
taxon (e.g. taxon="Alaba vibex") will probably work. 
However, for reliable results it is recommended to use a specific field where possible (see <code><a href='ala_fields.html'>ala_fields("occurrence_indexed")</a></code>
for valid fields). It is also good practice to quote the taxon name if it contains multiple words, for example
<code>taxon="taxon_name:\"Alaba vibex\""</code></p></td>
    </tr>
    <tr>
      <th>wkt</th>
      <td><p>string: (optional) a WKT (well-known text) string providing a spatial polygon within which to search, e.g. "POLYGON((140 -37,151 -37,151 -26,140.131 -26,140 -37))"</p></td>
    </tr>
    <tr>
      <th>fq</th>
      <td><p>string: (optional) character string or vector of strings, specifying filters to be applied to the original query. These are of the form "INDEXEDFIELD:VALUE" e.g. "kingdom:Fungi". 
See <code><a href='ala_fields.html'>ala_fields("occurrence_indexed",as_is=TRUE)</a></code> for all the fields that are queryable. 
NOTE that fq matches are case-sensitive, but sometimes the entries in the fields are 
not consistent in terms of case (e.g. kingdom names "Fungi" and "Plantae" but "ANIMALIA"). 
fq matches are ANDed by default (e.g. c("field1:abc","field2:def") will match records that have 
field1 value "abc" and field2 value "def"). To obtain OR behaviour, use the form c("field1:abc 
OR field2:def"). See e.g. <a href='http://wiki.apache.org/solr/CommonQueryParameters'>http://wiki.apache.org/solr/CommonQueryParameters</a> for more information about filter queries</p></td>
    </tr>
    <tr>
      <th>fields</th>
      <td><p>string vector: (optional) a vector of field names to return. Note that the columns of the returned data frame 
are not guaranteed to retain the ordering of the field names given here. If not specified, a default list of fields will be returned. See <code><a href='ala_fields.html'>ala_fields("occurrence_stored")</a></code> for valid field names with method <code>indexed</code>, and <code><a href='ala_fields.html'>ala_fields("occurrence")</a></code> for valid field names with method <code>offline</code>. Field names can be passed as full names (e.g. "Radiation - lowest period (Bio22)") rather than id ("el871"). Use <code>fields="all"</code> to include all available fields, but note that <code>"all"</code> will probably cause an error with <code>method="offline"</code> because the request URL will exceed the maximum allowable length</p></td>
    </tr>
    <tr>
      <th>extra</th>
      <td><p>string vector: (optional) a vector of field names to include in addition to those specified in <code>fields</code>. This is useful if you would like the default list of fields (i.e. when <code>fields</code> parameter is not specified) plus some additional extras. See <code><a href='ala_fields.html'>ala_fields("occurrence_stored",as_is=TRUE)</a></code> for valid field names. Field names can be passed as full names (e.g. "Radiation - lowest period (Bio22)") rather than id ("el871"). Use <code>extra="all"</code> to include all available fields, but note that <code>"all"</code> will probably cause an error with <code>method="offline"</code> because the request URL will exceed the maximum allowable length</p></td>
    </tr>
    <tr>
      <th>qa</th>
      <td><p>string vector: (optional) list of record issues to include in the download. Use <code>qa="all"</code> to include all available issues, or <code>qa="none"</code> to include none. Otherwise see <code><a href='ala_fields.html'>ala_fields("assertions",as_is=TRUE)</a></code> for valid values</p></td>
    </tr>
    <tr>
      <th>method</th>
      <td><p>string: "indexed" (default) or "offline". In "offline" mode, more fields are available and larger datasets can be returned</p></td>
    </tr>
    <tr>
      <th>email</th>
      <td><p>string: the email address of the user performing the download (required for <code>method="offline"</code></p></td>
    </tr>
    <tr>
      <th>download_reason_id</th>
      <td><p>numeric or string: (required unless record_count_only is TRUE) a reason code for the download, either as a numeric ID (currently 0--11) or a string (see <code><a href='ala_config.html'>ala_reasons</a></code> for a list of valid ID codes and names). The download_reason_id can be passed directly to this function, or alternatively set using <code><a href='ala_config.html'>ala_config(download_reason_id=...)</a></code></p></td>
    </tr>
    <tr>
      <th>reason</th>
      <td><p>string: (optional) user-supplied description of the reason for the download. Providing this information is optional but will help the ALA to better support users by building a better understanding of user communities and their data requests</p></td>
    </tr>
    <tr>
      <th>verbose</th>
      <td><p>logical: show additional progress information? [default is set by ala_config()]</p></td>
    </tr>
    <tr>
      <th>record_count_only</th>
      <td><p>logical: if TRUE, return just the count of records that would be downloaded, but don't download them. Note that the record count is always re-retrieved from the ALA, regardless of the caching settings. If a cached copy of this query exists on the local machine, the actual data set size may therefore differ from this record count. <code>record_count_only=TRUE</code> can only be used with <code>method="indexed"</code></p></td>
    </tr>
    <tr>
      <th>use_layer_names</th>
      <td><p>logical: if TRUE, layer names will be used as layer column names in the returned data frame (e.g. "radiationLowestPeriodBio22"). Otherwise, layer id value will be used for layer column names (e.g. "el871")</p></td>
    </tr>
    <tr>
      <th>use_data_table</th>
      <td><p>logical: if TRUE, attempt to read the data.csv file using the fread function from the data.table package. Requires data.table to be available. If this fails with an error or warning, or if use_data_table is FALSE, then read.table will be used (which may be slower)</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>Data frame of occurrence results, with one row per occurrence record. The columns of the dataframe will depend on the requested fields</p>
    
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <ul>
<li><p>Associated ALA web service for record counts: <a href='http://api.ala.org.au/#ws3'>http://api.ala.org.au/#ws3</a></p></li>
<li><p>Associated ALA web service for occurence downloads: <a href='http://api.ala.org.au/#ws4'>http://api.ala.org.au/#ws4</a></p></li>
<li><p>Field definitions: <a href='https://docs.google.com/spreadsheet/ccc?key=0AjNtzhUIIHeNdHhtcFVSM09qZ3c3N3ItUnBBc09TbHc'>https://docs.google.com/spreadsheet/ccc?key=0AjNtzhUIIHeNdHhtcFVSM09qZ3c3N3ItUnBBc09TbHc</a></p></li>
<li><p>WKT reference: <a href='http://www.geoapi.org/3.0/javadoc/org/opengis/referencing/doc-files/WKT.html'>http://www.geoapi.org/3.0/javadoc/org/opengis/referencing/doc-files/WKT.html</a></p></li>
</ul>
    
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='ala_config.html'>ala_reasons</a></code> for download reasons; <code><a href='ala_config.html'>ala_config</a></code></p></div>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><span class='co'># NOT RUN {</span>
<span class='co'>## count of records from this data provider</span>
<span class='no'>x</span> <span class='kw'>&lt;-</span> <span class='fu'>occurrences</span>(<span class='kw'>taxon</span><span class='kw'>=</span><span class='st'>"data_resource_uid:dr356"</span>,<span class='kw'>record_count_only</span><span class='kw'>=</span><span class='fl'>TRUE</span>)
<span class='co'>## download records, with standard fields</span>
<span class='no'>x</span> <span class='kw'>&lt;-</span> <span class='fu'>occurrences</span>(<span class='kw'>taxon</span><span class='kw'>=</span><span class='st'>"data_resource_uid:dr356"</span>,<span class='kw'>download_reason_id</span><span class='kw'>=</span><span class='fl'>10</span>)
<span class='co'>## download records, with all fields</span>
<span class='no'>x</span> <span class='kw'>&lt;-</span> <span class='fu'>occurrences</span>(<span class='kw'>taxon</span><span class='kw'>=</span><span class='st'>"data_resource_uid:dr356"</span>,<span class='kw'>download_reason_id</span><span class='kw'>=</span><span class='fl'>10</span>,
  <span class='kw'>fields</span><span class='kw'>=</span><span class='fu'><a href='ala_fields.html'>ala_fields</a></span>(<span class='st'>"occurrence_stored"</span>,<span class='kw'>as_is</span><span class='kw'>=</span><span class='fl'>TRUE</span>)$<span class='no'>name</span>)
<span class='co'>## download records, with specified fields</span>
<span class='no'>x</span> <span class='kw'>&lt;-</span> <span class='fu'>occurrences</span>(<span class='kw'>taxon</span><span class='kw'>=</span><span class='st'>"genus:Heleioporus"</span>,<span class='kw'>fields</span><span class='kw'>=</span><span class='fu'>c</span>(<span class='st'>"longitude"</span>,<span class='st'>"latitude"</span>,
  <span class='st'>"common_name"</span>,<span class='st'>"taxon_name"</span>,<span class='st'>"el807"</span>),<span class='kw'>download_reason_id</span><span class='kw'>=</span><span class='fl'>10</span>)
 <span class='co'>## download records in polygon, with no quality assertion information</span>
<span class='no'>x</span> <span class='kw'>&lt;-</span> <span class='fu'>occurrences</span>(<span class='kw'>taxon</span><span class='kw'>=</span><span class='st'>"genus:Heleioporus"</span>,
  <span class='kw'>wkt</span><span class='kw'>=</span><span class='st'>"POLYGON((145 -37,150 -37,150 -30,145 -30,145 -37))"</span>,
  <span class='kw'>download_reason_id</span><span class='kw'>=</span><span class='fl'>10</span>,<span class='kw'>qa</span><span class='kw'>=</span><span class='st'>"none"</span>)

<span class='no'>y</span> <span class='kw'>&lt;-</span> <span class='fu'>occurrences</span>(<span class='kw'>taxon</span><span class='kw'>=</span><span class='st'>"taxon_name:\"Alaba vibex\""</span>,<span class='kw'>fields</span><span class='kw'>=</span><span class='fu'>c</span>(<span class='st'>"latitude"</span>,<span class='st'>"longitude"</span>,<span class='st'>"el874"</span>),
  <span class='kw'>download_reason_id</span><span class='kw'>=</span><span class='fl'>10</span>)
<span class='fu'>str</span>(<span class='no'>y</span>)
<span class='co'># equivalent direct webservice call [see this by setting ala_config(verbose=TRUE)]:</span>
<span class='co'># http://biocache.ala.org.au/ws/occurrences/index/download?q=taxon_name%3A%22Alaba%20vibex%22&amp;</span>
<span class='co'># fields=latitude,longitude,el874&amp;reasonTypeId=10&amp;sourceTypeId=2001&amp;esc=%5C&amp;sep=%09&amp;file=data</span>

<span class='fu'>occurrences</span>(<span class='kw'>taxon</span><span class='kw'>=</span><span class='st'>"taxon_name:\"Eucalyptus gunnii\""</span>,<span class='kw'>fields</span><span class='kw'>=</span><span class='fu'>c</span>(<span class='st'>"latitude"</span>,<span class='st'>"longitude"</span>),
  <span class='kw'>qa</span><span class='kw'>=</span><span class='st'>"none"</span>,<span class='kw'>fq</span><span class='kw'>=</span><span class='st'>"basis_of_record:LivingSpecimen"</span>,<span class='kw'>download_reason_id</span><span class='kw'>=</span><span class='fl'>10</span>)
<span class='co'># equivalent direct webservice call [see this by setting ala_config(verbose=TRUE)]:</span>
<span class='co'># http://biocache.ala.org.au/ws/occurrences/index/download?q=taxon_name%3A%22Eucalyptus%20gunnii%22&amp;</span>
<span class='co'># fq=basis_of_record%3ALivingSpecimen&amp;fields=latitude,longitude&amp;qa=none&amp;reasonTypeId=10&amp;</span>
<span class='co'># sourceTypeId=2001&amp;esc=%5C&amp;sep=%09&amp;file=data</span>
<span class='co'># }</span></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#references">References</a></li>

      <li><a href="#see-also">See also</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Peggy Newman, Ben Raymond, Jeremy VanDerWal, Lee Belbin.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  

  </body>
</html>

